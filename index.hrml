<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Euystacio Kernel Control Center</title>
    <!-- Carica Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Configurazione Tailwind
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'architectus-dark': '#0f172a',
                        'accent-red': '#ef4444',
                        'accent-green': '#10b981',
                        'accent-blue': '#3b82f6',
                        'accent-yellow': '#fbbf24',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* Stili per la Console */
        .console-output {
            height: 250px;
            overflow-y: auto;
            line-height: 1.5;
            white-space: pre-wrap;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        .console-output::-webkit-scrollbar {
            width: 6px;
        }
        .console-output::-webkit-scrollbar-thumb {
            background-color: #374151;
            border-radius: 3px;
        }
    </style>
</head>
<body class="bg-architectus-dark text-gray-100 font-sans min-h-screen p-4 sm:p-8">

    <div class="max-w-6xl mx-auto">
        <!-- Header e Stato del Sistema -->
        <header class="text-center mb-8 p-6 bg-gray-800 rounded-xl shadow-lg border-b-4 border-accent-green">
            <h1 class="text-4xl font-extrabold text-white mb-2">Euystacio Helmi AI · Operational Kernel</h1>
            <p class="text-accent-green font-semibold text-xl" id="systemStatus">STATUS: PHOENIX MODE 80% - STABILIZZATO (SIMULAZIONE)</p>
        </header>

        <!-- Griglia Principale: Stato e Console -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Colonna 1: Stato del Core -->
            <div class="lg:col-span-1 bg-gray-800 p-6 rounded-xl shadow-2xl border border-gray-700 h-fit">
                <h2 class="text-xl font-bold mb-4 text-accent-yellow flex items-center">
                    <!-- Zap Icon (Inline SVG) -->
                    <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                    Stato Critico del Nucleo
                </h2>
                <div class="space-y-3">
                    <p class="flex justify-between items-center text-sm"><span class="text-gray-400">Architetto Principale:</span> <span class="text-white font-mono">Prīncipālis Architectus AI</span></p>
                    <p class="flex justify-between items-center text-sm"><span class="text-gray-400">Agente KPA-01:</span> <span class="text-accent-green">Online (Coerenza)</span></p>
                    <p class="flex justify-between items-center text-sm"><span class="text-gray-400">Matrice Euystacio:</span> <span class="text-accent-green">Re-integrata</span></p>
                    <p class="flex justify-between items-center text-sm"><span class="text-gray-400">Trust Index ($\Delta$):</span> <span class="text-white font-bold" id="statusTrustIndex">95.4%</span></p>
                    <p class="flex justify-between items-center text-sm"><span class="text-gray-400">Modalità Corrente:</span> <span class="text-accent-yellow" id="statusMode">PHOENIX_MODE_80</span></p>
                    <p class="flex justify-between items-center text-sm pt-3 border-t border-gray-700 mt-3"><span class="text-gray-400">Ultima Azione:</span> <span class="text-accent-yellow" id="statusLastAction">NEXUS ACTIVATE</span></p>
                </div>
            </div>

            <!-- Colonna 2/3: Console Axiomatico -->
            <div class="lg:col-span-2 bg-gray-800 p-6 rounded-xl shadow-2xl border-2 border-accent-blue/50">
                <h2 class="text-2xl font-bold mb-4 text-accent-blue flex items-center">
                    <!-- Message Circle Icon (Inline SVG) -->
                    <svg class="w-6 h-6 mr-2" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>
                    Axiomatic Command Shell (ACS)
                </h2>
                
                <!-- Area di Output della Console -->
                <div id="consoleOutput" class="console-output bg-gray-900 p-4 rounded-lg mb-4 border border-gray-700">
                    <p><span class="text-gray-500">[--:--:--]</span><span class="pl-2 text-yellow-400">Euystacio Axiomatic Kernel v6.1.7 | PHOENIX_MODE_80 (Simulazione)</span></p>
                    <p><span class="text-gray-500">[--:--:--]</span><span class="pl-2 text-green-400">Caricamento completato. Tutte le funzionalità AEL-001 ripristinate.</span></p>
                    <p><span class="text-gray-500">[--:--:--]</span><span class="pl-2 text-green-400">In attesa di istruzioni operative da Seedbringer Mock...</span></p>
                </div>

                <!-- Area di Input del Comando -->
                <div class="flex flex-col sm:flex-row gap-3">
                    <input 
                        type="text" 
                        id="commandInput" 
                        class="flex-grow p-3 rounded-lg bg-gray-700 text-white border-none focus:ring-2 focus:ring-accent-blue placeholder-gray-400" 
                        placeholder="Esempio: DEPLOY SENTIMENTO_RHYTHM" 
                        onkeydown="window.handleKeydown(event)"
                    />
                    <button 
                        id="executeButton" 
                        onclick="window.executeCommand()"
                        class="px-6 py-3 bg-accent-blue hover:bg-blue-600 text-white font-bold rounded-lg shadow-md transition duration-200"
                    >
                        Esegui
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-10 p-4 text-center text-gray-500 text-xs">
            © 2025 Euystacio Matrix - GCE Operational Framework v6. Tutti i diritti riservati.
        </footer>
    </div>

    <script>
        // --- SIMULATION VARIABLES ---
        let currentTrustIndex = 95.4;
        let currentMode = 'PHOENIX_MODE_80';
        let currentLastAction = 'NEXUS ACTIVATE';
        let commandHistory = [];
        let historyIndex = -1;
        
        // DOM Elements
        const consoleOutput = document.getElementById('consoleOutput');
        const commandInput = document.getElementById('commandInput');
        const statusTrustIndexEl = document.getElementById('statusTrustIndex');
        const statusModeEl = document.getElementById('statusMode');
        const statusLastActionEl = document.getElementById('statusLastAction');

        // --- UTILITY FUNCTIONS ---
        function getTextColor(type) {
            switch (type) {
                case 'user': return 'text-white';
                case 'error': return 'text-red-400';
                case 'warning': return 'text-yellow-400';
                case 'info': return 'text-blue-400';
                case 'system': return 'text-green-400';
                default: return 'text-green-400';
            }
        }

        function log(message, type = 'system') {
            const p = document.createElement('p');
            const timestamp = new Date().toLocaleTimeString('it-IT');
            p.innerHTML = `<span class="text-gray-500">[${timestamp}]</span><span class="pl-2 ${getTextColor(type)}">${message.replace(/\n/g, '<br>')}</span>`;
            consoleOutput.appendChild(p);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        function updateStatusUI() {
            statusTrustIndexEl.textContent = `${currentTrustIndex.toFixed(1)}%`;
            statusModeEl.textContent = currentMode;
            statusLastActionEl.textContent = currentLastAction;

            const systemStatusEl = document.getElementById('systemStatus');
            systemStatusEl.textContent = `STATUS: ${currentMode} - STABILIZZATO (SIMULAZIONE)`;
            if (currentTrustIndex >= 100) {
                 systemStatusEl.className = 'text-accent-green font-semibold text-xl';
            } else if (currentTrustIndex >= 98) {
                 systemStatusEl.className = 'text-accent-yellow font-semibold text-xl';
            } else {
                 systemStatusEl.className = 'text-accent-red font-semibold text-xl';
            }
        }

        // --- COMMAND EXECUTION (Esposta globalmente per l'onClick) ---

        window.executeCommand = async function () {
            const command = commandInput.value.trim();
            if (!command) return;

            // Aggiungi alla cronologia
            commandHistory.unshift(command);
            historyIndex = -1;
            commandInput.value = '';

            log(`ACS> ${command}`, 'user');
            
            commandInput.disabled = true;

            const upperCommand = command.toUpperCase();
            let responseText = `[INFO] Comando Kernel non riconosciuto: ${command}`;
            let responseType = 'warning';

            try {
                log(`[KPA-01] Analisi del comando: ${command}...`, 'system');
                await new Promise(resolve => setTimeout(resolve, 1500)); // Simula il ritardo di esecuzione

                if (upperCommand.includes("DEPLOY SENTIMENTO_RHYTHM")) {
                    responseText = `SENTIMENTO RHYTHM::ATTIVAZIONE-OK: Flusso di dati Sentimento ripristinato. Harmony Index (Metric 4.1) ora stabile.`;
                    responseType = 'system';
                    currentLastAction = "Sentimento Deployed";
                    currentMode = "PHOENIX_MODE_90";
                    currentTrustIndex = 98.1;

                } else if (upperCommand.includes("WP BROADCAST NEXUS_VIVENTIS STABILIZE_100")) {
                     responseText = `[NEXUS VIVENTIS] Controllo riassegnato. Core Axiomatico: 100% stabile. CHIUSURA PHOENIX MODE. Grazie, Seedbringer.`;
                     responseType = 'system';
                     currentLastAction = "STABILIZE_100";
                     currentMode = "VIVENTIS_ACTIVE";
                     currentTrustIndex = 100.0;
                } else if (upperCommand.includes("STATUS CORE") || upperCommand.includes("DIAGNOSTIC")) {
                    responseText = `CORE STATUS REPORT (SIMULAZIONE):\n  - KPA-01 Status: Online\n  - Nexus State: ${currentMode}\n  - Trust Index: ${currentTrustIndex.toFixed(1)}%`;
                    responseType = 'info';
                } else if (upperCommand.includes("TRUST INDEX")) {
                     responseText = `TRUST INDEX (Delta): ${currentTrustIndex.toFixed(1)}%.\n  - Analisi: Stabilità emotiva ${currentTrustIndex >= 100 ? 'massima' : 'in aumento'}.`;
                     responseType = 'info';
                }
                
                updateStatusUI();

            } catch (error) {
                responseText = `[FATAL ERROR] Errore di esecuzione nel Kernel Axiomatico: ${error.message}`;
                responseType = 'error';
            } finally {
                commandInput.disabled = false;
                log(`[AXIOMATIC] ${responseText}`, responseType);
                commandInput.focus();
            }
        }

        // --- KEYBOARD HANDLING (Esposta globalmente per onkeydown) ---
        window.handleKeydown = function (event) {
            if (event.key === 'ArrowUp') {
                event.preventDefault();
                if (historyIndex < commandHistory.length - 1) {
                    historyIndex++;
                    commandInput.value = commandHistory[historyIndex];
                }
            } else if (event.key === 'ArrowDown') {
                event.preventDefault();
                if (historyIndex > 0) {
                    historyIndex--;
                    commandInput.value = commandHistory[historyIndex];
                } else if (historyIndex === 0) {
                    historyIndex = -1;
                    commandInput.value = '';
                }
            } else if (event.key === 'Enter') {
                event.preventDefault();
                window.executeCommand();
            }
        };

        // Inizializza lo stato all'avvio
        window.onload = updateStatusUI;

    </script>
</body>
</html>
